<!doctype html>
<html>
<head>

	<!-- Meta Tag -->
	<meta charset="utf-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="virapay" />
	<meta name="keywords" content="virapay, vira, pay" />
	<meta id="theme-color" name="theme-color" content="#ffffff">
	<meta name="yandex-verification" content="0e027f9006505dab" />

	<!-- Prepare -->
	<link rel="preconnect" href="https://code.iconify.design"/>
	<link rel="preconnect" href="https://fonts.googleapis.com"/>

	<!-- Webfonts -->
	<link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet" crossorigin="anonymous">
<!--	<link href="https://cdn.materialdesignicons.com/5.0.45/css/materialdesignicons.min.css" rel="stylesheet" crossorigin="anonymous"/>-->

	<!-- UI framework -->
	<link href="css/typography.css" rel="stylesheet"/>

	<!-- Common -->
	<link href="css/common.css?v=0.1" rel="stylesheet"/>

	<!-- JSONRPC2 -->
	<script src="js/JSONRPC2.js" type="text/javascript" charset="utf-8"></script>

	<!-- Storage -->
	<script src="js/storage.js" type="text/javascript" charset="utf-8"></script>

</head>
<body>

	<div class="activity at-center loading -is-hidden">
		<div class="container">
			<i class="iconify mdi mdi-loading display4 spin" data-icon="mdi-loading"></i>
		</div>
	</div>

	<div class="activity -at-center message is-hidden" data-name="message" data-history="untracked">
		<div class="container">
			<h2 class="title"></h2>
			<p class="info">
				<i class="icon iconify mdi mdi-alert-outline" data-icon="mdi-alert-outline"></i>
				<span class="text"></span>
			</p>
			<button class="button primary action">
	            <span>Продолжить</span>
				<i class="icon iconify mdi mdi-arrow-right" data-icon="mdi-arrow-right"></i>
			</button>
		</div>
	</div>

	<!-- Iconify -->
	<script src="https://code.iconify.design/1/1.0.6/iconify.min.js"></script>

	<!-- Common -->
	<script src="js/common.js?v=0.1" type="text/javascript" charset="utf-8"></script>

	<!-- Entry point -->
	<script>

		(function () {

			let apiName = 'facebook'

			function homepage() {
				location.replace('/')
			}

			let p = parseParameters(location.search)
			if (p.code) {
				backend.oauth2(apiName, p.code).then(token => {
					storagePut(`/${location.hostname}/session`, token)
					homepage()
				}).catch(error => {
					showMessage('Вход через Facebook', 'Не удалось получить токен. Попробуйте позднее.', homepage)
				})
			} else {
				showMessage('Вход через Facebook', 'Не удалось выполнить вход. Попробуйте позднее.', homepage)
			}

		})();

	</script>

</body>
</html>